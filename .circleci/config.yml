version: 2.1
workflows:
  version: 2
  build_push_test:
    jobs:
      - playground/npmbuild_and_persist:
          package_lock_location: "web/wp-content/themes/stevector-sage"
          path_to_persist: "web/wp-content/themes/stevector-sage/dist"
          build_command: "npm run build:production"



      - playground/push:
          pre-steps:
            - playground/composer_install_no_dev
            - attach_workspace:
                at: .
          requires:
            - playground/npmbuild_and_persist
      - playground/backstop:
          requires:
            - playground/build
      - playground/merge:
          requires:
             - playground/backstop
orbs:
  playground: fauxalgore/playground@dev:seventh
